\begin{pdfpic}
\setlength{\unitlength}{1cm}
\pspicture*(10,8)(-2,-1)
\psset{unit=1cm}
\psset{fillstyle=none}
\psline[linestyle=solid](0,0)(6,1)
\psline[linestyle=solid](6,1)(8,3)
\psline[linestyle=dashed](8,3)(2,2)
\psline[linestyle=dashed](2,2)(0,0)
\pspolygon[linestyle=solid](0,4)(6,5)(8,7)(2,6)
\psline[linestyle=solid](0,0)(0,4)
\psline[linestyle=solid](6,5)(6,1)
\psline[linestyle=solid](8,7)(8,3)
\psline[linestyle=dashed](2,2)(2,6)
\rput[B](0.8,3.2){$w, \dot{q}^z, \dot{q}_z$}
\rput[B](0.8,2.8){$z$}
\rput[B](2.8,2.4){$z$}
\rput[B](6.9,4.2){$w, \dot{q}^z, \dot{q}_z$}
\rput[B](7.2,3.8){$z$}
\rput[B](5.2,4.4){$z$}
\rput[B](0.6,5.0){$\varrho, \theta_v$}
\rput[B](0.6,1.0){$\varrho, \theta_v$}
\rput[B](7.5,2.0){$\varrho, \theta_v$}
\rput[B](7.5,6.0){$\varrho, \theta_v$}
\rput[B](4.2,1.2){$\dot{x}_n, \dot{q}^n, \dot{q}_n$}
\rput[B](4.0,5.6){$\dot{x}_n, \dot{q}^n, \dot{q}_n$}
\rput[B](-0.8,2.8){\tt l:=k-1/2}
\rput[Br](9.6,4.0){\tt l:=k-1/2}
\rput[B](8.2,2.0){\tt k}
\rput[B](-0.4,1.0){\tt k}
\rput[B](8.4,6.0){\tt k-1}
\rput[B](-0.4,5.0){\tt k-1}
\rput[b](-0.2,0.1){\tt i}
\rput[b](3.4,0.0){\tt j:=i+1/2}
\rput[b](6.0,0.1){\tt i+1}
\psset{linecolor=red}
\pspolygon[linestyle=dashed](3,0.5)(5,2.5)(1,1)
\pspolygon[linestyle=solid](3,4.5)(5,6.5)(1,5)
\psline[linestyle=solid](3,0.5)(3,4.5)
\psline[linestyle=dashed](5,2.5)(5,6.5)
\psline[linestyle=dashed](1,1)(1,5)
\psset{linecolor=gray,linestyle=dotted}
\pspolygon(3,0.5)(5,2.5)(7,2)
\pspolygon(3,4.5)(5,6.5)(7,6)
\psline(3,0.5)(3,4.5)
\psline(5,2.5)(5,6.5)
\psline(7,2)(7,6)
\psset{linecolor=green,linestyle=dotted}
\psline(1,5)(7,6)
\psline(1,1)(7,2)
\psset{linecolor=black}
\qdisk(1,3){2pt}
\qdisk(7,4){2pt}
\qdisk(4,5.5){2pt}
\qdisk(1,1){2pt}
\qdisk(7,2){2pt}
\qdisk(4,1.5){2pt}
\qdisk(7,6){2pt}
\qdisk(1,5){2pt}
\qdisk(5,4.5){2pt}
\qdisk(3,2.5){2pt}
\psline[linecolor=blue](1,3)(7,4)
\psline[linecolor=blue](4,1.5)(4,5.5)
\psline[linecolor=blue](3,2.5)(5,4.5)
\psset{linestyle=solid}
\psline[linecolor=blue,arrowscale=2]{->}(4,3.5)(5,3.6667)
\psline[linecolor=blue,arrowscale=2]{->}(4,3.5)(4,4.5)
\psline[linecolor=blue,arrowscale=2]{->}(4,3.5)(4.5,4)
\rput[B](5.2,3.8){\color{blue}$\mathbf{q_n}$}
\rput[B](4.3,4.4){\color{blue}$\mathbf{q_z}$}
\rput[B](4.7,4.1){$\mathbf{{\color{gray}q}^{\color{green}t}_{\color{blue}t}}$}
\psline[linecolor=green,arrowscale=2]{->}(4,3.5)(5,3.5)
\psline[linecolor=green,linestyle=dashed](4,3.5)(4.5,4)
\psline[linecolor=green,arrowscale=2]{->}(4,3.5)(3.85,4.4)
\rput[B](5.2,3.3){\color{green}$\mathbf{q^n}$}
\rput[B](3.6,4.3){\color{green}$\mathbf{q^z}$}
\endpspicture
\end{pdfpic}

