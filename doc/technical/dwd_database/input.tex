\chapter{Mandatory input fields}

Several input files are needed to perform runs of the ICON model. 
%
These can be divided into three classes:
%
Grid files, external parameters, and initialization (analysis) files. The latter 
will be described in Chapter \ref{sec_analysis}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Grid Files}
\label{section:grid_files}


% TODO[FP,DR]: Please add here information
% on the
% - UUID, numberOfGridUsed
% - additional neighbor relationship info (neighbor cell)
% - general remark: What is NetCDF; mention tools for processing NetCDF


In order to run ICON, it is necessary to load the horizontal grid
information as an input para\-meter. 
This information is stored within so-called grid files. For an ICON 
run, at least one global grid file is required.
For model runs with nested grids, additional files of the nested
domains are necessary. Optionally, a reduced radiation grid for
the global domain may be used.

%
The unstructured triangular ICON grid resulting from the grid
generation process is represented in NetCDF format.  The most
important data entries are

\begin{itemize}
 \item \texttt{cell} (INTEGER dimension) \\
        number of (triangular) cells
 \item \texttt{vertex} (INTEGER dimension) \\
        number of triangle vertices
 \item \texttt{edge} (INTEGER dimension) \\
        number of triangle edges
 \item \texttt{clon}, \texttt{clat} (double array, dimension: \#triangles, given in radians) \\
        longitude/latitude of the triangle circumcenters
 \item \texttt{vlon}, \texttt{vlat} (double array, dimension: \#triangle vertices, given in radians) \\
        longitude/latitude of the triangle vertices
 \item \texttt{elon}, \texttt{elat} (double array, dimension: \#triangle edges, given in radians) \\
       longitude/latitude of the edge midpoints
 \item \texttt{cell\_area} (double array, dimension: \#triangles) \\
       triangle areas
 \item \texttt{vertex\_of\_cell} (INTEGER array, dimensions: [3, \#triangles]) \\
       The indices \texttt{vertex\_of\_cell(:,i)} denote the triangle vertices that belong 
       to the triangle~\texttt{i}.
 \item \texttt{edge\_of\_cell} (INTEGER array, dimensions: [2, \#triangles]) \\
       The indices \texttt{edge\_of\_cell(:,i)} denote the triangle edges that belong
       to the triangle~\texttt{i}.
\end{itemize}

%For fixed domain sizes and resolutions a list of grid files has been pre-built for the ICON model.
%These are publically available via the download server
%{\normalsize%
%\begin{verbatim}
%   http://icon-downloads.zmaw.de
%\end{verbatim}
%}%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{External parameters}
\label{section:extpar}
External parameters are used to describe the properties of the earth's surface. 
These data include e.g.\ the orography, the land-sea-mask as well as parameters describing 
soil and surface properties, like the soiltype or the plant cover fraction.

The ExtPar software (ExtPar -- External parameter for Numerical Weather Prediction and Climate Application) 
is able to generate external parameters for the ICON model. The generation is based on a set of 
raw datafields which are listed in Table \ref{table_extpar_raw}. For a more detailed overview of ExtPar, 
the reader is referred to the \emph{User and Implementation Guide} of Extpar.

\begin{longtable}{p{6.5cm}p{6cm}p{1.8cm}}
\captionabove[]{Raw datasets from which the ICON external parameter fields are derived.}\label{table_extpar_raw}\\
  \toprule
\textbf{Dataset} &\textbf{Source} &\textbf{Resolution} \\
\midrule
\endfirsthead
\caption[]{\emph{continued}}\\
\midrule
\endhead
\hline \multicolumn{3}{r}{\textit{Continued on next page}} \\
\endfoot
\endlastfoot
GLOBE orography                                        &  NOAA/NGDC                  &  30'' \\
%ASTER orography \newline (limited domain: 60 N - 60 S) &  METI/NASA                  &  1''   \\
GlobCover 2009                                         &  ESA                        &  10''  \\
%GLC2000 land use                                       &  JRC Ispra                  &  30''  \\
GLCC land use                                          &  USGS                       &  30''  \\
DSMW Digital Soil Map of the World                     &  FAO                        &  5'    \\
%HWSD Harmonized World Soil Database                    &  FAO/IIASA/ISRIC/ISSCAS/JRC &  30''  \\
NDVI Climatotology, SeaWiFS                            &  NASA/GSFC                  &  2.5'  \\
CRU near surface climatology                           &  CRU University of East Anglia & $0.5^{\circ}$  \\
GACP Aerosol Optical thickness                         &  NASA/GISS \newline (Global Aerosol Climatology Project)   &  $4x5^{\circ}$ \\
GLDB Global lake database                              &  DWD/RSHU/MeteoFrance       &  30''  \\
MODIS albedo                                           &  NASA                       &  5'    \\
\bottomrule
\end{longtable}

\emph{GlobCover 2009} is a land cover database covering the whole globe, except for Antarctica. Therefore, we make use of 
\emph{GlobCover 2009} for $90^{\circ} > \phi > -56^{\circ}$ (with $\phi$ denoting latitude) and switch to the coarser, 
however globally available dataset \emph{GLCC} for $ -56^{\circ} \geq \psi > -90^{\circ}$.

The products generated by the ExtPar software package are listed in Table \ref{table_extpar_products} together with the underlying 
raw dataset. These are mandatory input fields for assimilation- and forecast runs.

\begin{longtable}{p{2.5cm}p{8.5cm}p{3.3cm}}
\captionabove[]{External parameter fields for ICON, produced by the ExtPar software package (in alphabetical order)}\label{table_extpar_products}\\
% \begin{tabular}{p{2.5cm}p{8.5cm}p{3.3cm}}
  \toprule
\multicolumn{1}{c}{\textbf{ShortName}}  &  \multicolumn{1}{c}{\textbf{Description}}  &  \multicolumn{1}{c}{\textbf{Raw dataset}}\\
\midrule
\endfirsthead
\caption[]{\emph{continued}}\\
\midrule
\endhead
\hline \multicolumn{3}{r}{\textit{Continued on next page}} \\
\endfoot
\endlastfoot
  AER\_SS12                             & Sea salt aerosol climatology (monthly fields)   &       GACP                \\
  AER\_DUST12                           & Total soil dust aerosol climatology (monthly fields) &  GACP                \\
  AER\_ORG12                            & Organic aerosol climatology (monthly fields)       &    GACP                \\
  AER\_SO412                            & Total sulfate aerosol climatology (monthly fields) &    GACP                \\
  AER\_BC12                             & Black carbon aerosol climatology (monthly fields)  &    GACP                \\
  ALB\_DIF12                            & Shortwave ($0.3 - 5.0\, \mathrm{\mu m}$) albedo for diffuse radiation (monthly fields)&  MODIS    \\
  ALB\_UV12                             & UV-visible ($0.3 - 0.7\, \mathrm{\mu m}$) albedo for diffuse radiation (monthly fields)& MODIS     \\
  ALB\_NI12                             & Near infrared ($0.7 - 5.0\, \mathrm{\mu m}$) albedo for diffuse radiation (monthly fields)& MODIS     \\
  DEPTH\_LK                             & Lake depth                                      &        GLDB               \\
  EMIS\_RAD                             & Surface longwave (thermal) emissivity           &        GlobCover 2009     \\               
  FOR\_D  (*)                           & Fraction of deciduous forest                    &        GlobCover 2009     \\
  FOR\_E  (*)                           & Fraction of evergreen forest                    &        GlobCover 2009     \\
  FR\_LAKE                              & Lake fraction (fresh water)                     &        GLDB               \\                     
  FR\_LAND                              & Land fraction (excluding lake fraction but including glacier fraction) & GlobCover2009   \\
  FR\_LUC                               & Landuse class fraction                          &                           \\
  HSURF                                 & Orography height at cell centres                &        GLOBE              \\
  LAI\_MX  (*)                          & Leaf area index in the vegetation phase         &        GlobCover 2009     \\
  NDVI\_MAX                             & Normalized differential vegetation index        &        SeaWiFS            \\
  NDVI\_MRAT                            & proportion of monthly mean NDVI to yearly maximum (monthly fields)&  SeaWiFS \\
  PLCOV\_MX  (*)                        & Plant covering degree in the vegetation phase   &        GlobCover 2009     \\
  ROOTDP (*)                            & Root depth                                      &        GlobCover 2009     \\
  RSMIN  (*)                            & Minimum stomatal resistance                     &        GlobCover 2009     \\
  SOILTYP                               & Soil type                                       &        DSMW               \\
  SSO\_STDH                             & Standard deviation of sub-grid scale orographic height  &   GLOBE           \\
  SSO\_THETA                            & Principal axis-angle of sub-grid scale orography &          GLOBE           \\
  SSO\_GAMMA                            & Horizontal anisotropy of sub-grid scale orography &         GLOBE           \\
  SSO\_SIGMA                            & Average slope of sub-grid scale orography       &           GLOBE           \\
  T\_2M\_CL                             & Climatological 2m temperature (serves as lower boundary condition for soil model)  &  CRU \\
  Z0 (*)                                & Surface roughness length (over land), containing a contribution from subgrid-scale orography  & GlobCover 2009    \\                        
  \bottomrule
% \end{tabular}
\end{longtable}

Note that fields marked with (*) are not required in operational model runs. I.e.\ the surface roughness \texttt{Z0} is only required, 
if the additional contribution from sub-grid scale orography shall be taken into account (i.e.\ for \nml{itype\_z0=1}). In operational runs 
this is not the case. Instead, land-cover class specific roughness lengths are taken from a GlobCover-based lookup table. 
\texttt{FOR\_D}, \texttt{FOR\_E}, \texttt{LAI\_MX}, \texttt{PLCOV\_MX}, 
\texttt{RSMIN}, and \texttt{ROOTDP} became obsolete with the activation of the surface tile approach (2015-03-04). The latter $4$ fields 
are replaced by land-cover class specific values taken from lookup tables.



\subsubsection*{Remarks on post-processing}
Some of the external parameter fields are further modified by ICON. The following fields are affected: 
\begin{tabbing}
\hspace{0.20\textwidth} \= \hspace{0.20\textwidth} \= \hspace{0.20\textwidth} \= \hspace{0.20\textwidth} \= \hspace{0.20\textwidth} \kill
\texttt{DEPTH\_LK}  \>
\texttt{HSURF} \>
\texttt{FR\_LAND} \>
\texttt{FR\_LAKE} \>
\texttt{Z0}
%\texttt{SSO\_STDH}
%DR Note that sso_stdh is affected as well, however we do not output it!
\end{tabbing}
Thus, for consistency, the modified fields should be used for post-processing tasks rather than the original external parameter fields. 
See Section \ref{sec_const_outfields} for more details.
