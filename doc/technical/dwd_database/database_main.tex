\documentclass[a4paper,twoside,10pt]{book}

\usepackage[english]{babel}
\usepackage{float}
\usepackage{xparse}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{pgfplots,pgfplotstable}
\usepackage{colortbl}
\usepackage[notoday,nofancy]{svninfo}

\usepackage[nottoc]{tocbibind}     %--- adds bibliography to toc 
% --- but without toc itself [nottoc] 
\usepackage[round,sort,comma,authoryear]{natbib} %--- creates bibliography; author-year with curly brackets within the text
% \usepackage[  %--- no numbering of positions 
% toc,           %--- let it appear in the document's table of contents
% style=mylong3colheader %--- see glossaries Documentation for a list of available styles
% ]{glossaries}  %--- use the glossary package
\geometry{a4paper,textwidth=15.8cm,textheight=23.0cm,twoside,rmargin=0.96in} %--- Variation Randbereiche
\usepackage{caption}
\usepackage{subcaption}  %--- simplifies putting pictures side by side
\usepackage{longtable}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{supertabular}
\usepackage{booktabs}    % to give tables a more professional look
\usepackage{rotating}    % rotate column labels
\usepackage{xcolor}
\usepackage{listings}
\usepackage{hyperref}    % ability to create hyperlinks within the document
\usepackage{vhistory}
\usepackage{tikz}
\usepackage{etex}
\usepackage{xargs}
\usepackage{xstring}
\usepackage{enumitem}
\usepackage[strict]{changepage} % for adjustwidth environment
\usepackage{framed}
\usepackage{array}
\usepackage[titletoc]{appendix}
\usepackage{soul}



% left-aligned fixed-width table column
\newcolumntype{P}[1]{>{\raggedright\arraybackslash}p{#1}}


% define some colors
\definecolor{darkred}{rgb}{0.5,0.,0.}
\definecolor{darkblue}{rgb}{0.,0.,0.6}
\definecolor{darkgreen}{rgb}{0.,0.5,0.}
\definecolor{darkgrey}{rgb}{0.7,0.75,0.71}
\definecolor{Gray}{gray}{0.9}

% textcolors
\newcommand{\tred}{\textcolor{red}}
\newcommand{\tblu}{\textcolor{blue}}
\newcommand{\degree}{{\circ}}
\newcommand{\km}{\text{km}}


% customize hyperref
\hypersetup{colorlinks, linkcolor=darkblue, citecolor=blue, urlcolor=darkred, linktoc=all}



% Fortran environment
\lstnewenvironment{fortran}%
{\lstset{language=[95]Fortran,%
    basicstyle=\ttfamily\footnotesize\color{darkgreen},%
    breaklines=true,%
    commentstyle=\ttfamily\color{blue},%
    emptylines=0,%
    keywordstyle=\color{black}\ttfamily\bfseries,%
    backgroundcolor=\color{darkgrey!5},
    framexleftmargin=4mm,%
    frame=shadowbox,%
    rulesepcolor=\color{darkgreen}}}
{}


% Sky environment
\lstnewenvironment{skydb}%
{\lstset{language=SQL,%
    basicstyle=\ttfamily\footnotesize\color{black},%
    breaklines=true,%
    commentstyle=\ttfamily\color{blue},%
    emptylines=0,%
    keywordstyle=\color{black}\ttfamily\bfseries,%
    backgroundcolor=\color{darkgrey!5},
    framexleftmargin=4mm,%
    frame=shadowbox,%
    rulesepcolor=\color{darkgreen}}}
{}

% LaTeX macros that are later used to disable/enable rows in the
% tables of output fields (global/local domain):
\newcommand{\onlyglb}[1]{#1}
\newcommand{\onlyloc}[1]{#1}

\newcommand{\new}[1]{}
\newcommand{\pressurelevelsTriangular}{}
\newcommand{\pressurelevelsRegular}{}
\newcommand{\heightlevelsRegular}{}


\newcolumntype{x}[1]{%
  >{\centering\hspace{0pt}}p{#1}}%


% ---------- Glossary: All the stuff and more ----------%
% \newglossary{symbolslist}{sym}{sbl}{Symbolverzeichnis} % define new glossary i.e. a list of symbols
% \makeglossaries

% \input{./text/listofsymbols}  %--- include defined symbols



% ---------------bold caption for figures-------------------------%
\makeatletter
\long\def\@makecaption#1#2{%
  \fontfamily{cmr}
  \fontseries{m}
  \fontshape{sl}
  \fontsize{10pt}{11pt}
  \selectfont
  \vskip 10\p@
  \setbox\@tempboxa\hbox{{\bf#1:} #2}%
  \ifdim \wd\@tempboxa >\hsize
  {\bf #1:} #2\par
  \else
  \hbox to\hsize{\hfil\box\@tempboxa\hfil}%
  \fi}
\makeatother
% ----------------------------------------------------------------%

% sign function
\newcommand{\sgn}{\operatorname{sgn}}

% \newcommand{\markRed}{\tikz \fill[red!60] (0,0) rectangle (0.08,0.8em);}
% \newcommand{\markBlue}{\tikz \fill[blue!80] (0,0) rectangle (0.08,0.8em);}
% \newcommand{\markWhite}{\tikz \fill[white!100] (0,0) rectangle (0.08,0.8em);}

\newcommand{\markRed}{\begin{tikzpicture}[baseline,scale=0.15] 
                        \fill[red!60,draw=black] (0.1,0) -- (1,0) -- (1,1.7) -- cycle;
                        \fill[red!60,draw=black] (0,0.3) -- (0,2) -- (0.9,2) -- cycle;
                      \end{tikzpicture}}
\newcommand{\markBlue}{\begin{tikzpicture}[baseline,scale=0.15] 
                        \fill[blue!60,draw=black] (0,0)  rectangle ++(1,0.9);
                        \fill[blue!60,draw=black] (0,1.1) rectangle ++(1,0.9);
                      \end{tikzpicture}}
\newcommand{\markWhite}{\begin{tikzpicture}[baseline,scale=0.15] 
                        \fill[white!100,draw=white] (0.0,0) rectangle ++(1,2);
                      \end{tikzpicture}}


%% Macro for indicating whether field is available on native grid
%% (tri), lat-lon grid (ll), or both
%
% This is using LaTeX 3 to trim white space around macro arguments!
\newcommand{\groupsinner}[2]{
  \IfEqCase{#1}{%
      {tri}{%
           \IfEqCase{#2}{%
           {ll}{\markRed\hspace*{0.1em}\markBlue}}      %group (tri,ll)
           [\markRed\hspace*{0.1em}\markWhite]          %group (tri)
      }%
  }[%
           \IfEqCase{#2}{%
           {ll}{\markWhite\hspace*{0.1em}\markBlue}}     %group (ll)
  ]
}
%%% Now we go with LaTeX3
\ExplSyntaxOn
\NewDocumentCommand{\groups}{ O{none} O{none} }
 {
  \latex_groups_node:nn
   { \tl_trim_spaces:n { #1 } }
   { \tl_trim_spaces:n { #2 } }
 }
\cs_set_eq:NN \latex_groups_node:nn \groupsinner
\cs_generate_variant:Nn \latex_groups_node:nn { xx }
\ExplSyntaxOff

% width of column containing grid native/lon-lat marks
\newcommand{\markcolwidth}{0.50cm}
% longtable header settings
\newenvironment{vartable}[1]{%
\begin{longtable}{%
@{}p{\markcolwidth}%
@{\hskip 0.05in}%
p{2.0cm}%
>{\small\raggedright}p{5cm}<{\normalsize}%
p{0.5cm}%
p{0.5cm}%
p{0.5cm}%
p{1.4cm}p{1cm}p{1cm}}#1\\
  \toprule
&\multicolumn{1}{c}{\begin{sideways}\textbf{ShortName}\end{sideways}}  &  \multicolumn{1}{c}{\rb{\textbf{Description}}}  & \begin{sideways}\textbf{Discipline}\end{sideways} & \begin{sideways}\bf{Category}\end{sideways} & \begin{sideways}\bf{Number}\end{sideways}  & \begin{sideways}\bf{Lev-Typ 1/2}\end{sideways}  & \begin{sideways}\bf{stepType}\end{sideways} &\begin{sideways}\bf{Unit}\end{sideways}\\
\midrule

\endfirsthead
\caption[]{\emph{continued}}\\
\midrule
\endhead
\hline \multicolumn{8}{r}{\textit{Continued on next page}} \\
\endfoot
\endlastfoot
}%
{%
  \bottomrule
\end{longtable}}

%
%
% mark Namelists
% - im Fliesstext:
\newcommand{\nml}[1]{\texttt{#1}}



% environment derived from framed.sty: see leftbar environment definition
\definecolor{formalshade}{rgb}{0.95,0.95,1}

\newenvironment{note}{%
  \def\FrameCommand{%
    \hspace{1pt}%
    {\color{darkblue}\vrule width 2pt}%
    {\color{formalshade}\vrule width 4pt}%
    \colorbox{formalshade}%
  }%
  \MakeFramed{\advance\hsize-\width\FrameRestore}%
  \noindent\hspace{-4.55pt}% disable indenting first paragraph
  \begin{adjustwidth}{}{7pt}%
%  \vspace{-2pt}\vspace{-2pt}%
}
{%
  %\vspace{2pt}%
  \end{adjustwidth}\endMakeFramed%
}


%\parskip0.4ex plus0.2ex minus0.3ex
\setlength{\parskip}{0.2cm plus0.1cm minus0.1cm}
\setlength{\parindent}{0.0em}

\includeonly{./preface_title_toc,
             ./preface_intro,
             ./preface_versionhistory,
             ./analysis,
             ./input,
             ./grid_geometry,
             ./output_GRIB2_global,
             ./output_GRIB2_nest,
             ./icon_in_sky,
             ./appendix,
             ./output_statproc,
             ./output_description,
             ./quote,
             ./cosmo_eu_fields.tex} 



% ------------------ start of document -----------------------%
\begin{document}
\svnInfo $Id$
\setcounter{tocdepth}{3}     %--- maximum toc depth


\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
% --- Seitenzahl bei geraden/linken Seiten nach links/aussen
% --- Seitenzahl bei ungeraden/rechten Seiten nach rechts/aussen
\fancyhead[EL,OR]{\thepage}
% --- Kapitel/Abschnitt bei geraden/linken Seiten rechts/aussen
\fancyhead[ER]{\leftmark}
% --- Unterkapitel/Unterabschnitt bei ungeraden/rechten Seiten links/aussen
\fancyhead[OL]{\rightmark}

\renewcommand{\chaptermark}[1]{%
  \markboth{\chaptername
    \ \thechapter.\ #1}{}}

\renewcommand{\sectionmark}[1]{
  \markright{\thesection.\ #1}
}

% --- Erhoehung des vertikalen Abstandes zwischen den Zeilen eines Arrays
\renewcommand{\arraystretch}{1.5}

% --- Auswahl der Formatierung des Literaturverzeichnisses (deutsche Version), erstellt mit custom-bib package
% \bibliographystyle{plain}
% \bibliographystyle{diss_bibstyle.bst}
\bibliographystyle{jas99}

% --- search path for figures
\graphicspath{{./pics/}}
% ----------------------------------------------------------------%

\frontmatter     %--- aendert Zahlen von Arabisch auf roemisch

% ---------------- Generate title page ---------------------%
\begin{titlepage}
  \include{./preface_title_toc}
\end{titlepage}
% ----------------------------------------------------------------%

%---- generate version history page -----------------%
\include{./preface_versionhistory}

% --------------------------------------------------------------------------------
\include{./quote}
% --------------------------------------------------------------------------------

\newpage
\pdfbookmark{\contentsname}{toc}
\tableofcontents              %--- generate table of contents

% remove chapter number from header for abstracts
\renewcommand{\chaptermark}[1] {
  \markboth{#1}{}
}


% shifting table captions...
\newcommand{\rb}[1]{\raisebox{4.0ex}[0pt]{#1}}

% use default again
\renewcommand{\chaptermark}[1]{%
  \markboth{\chaptername
    \ \thechapter.\ #1}{}}

\mainmatter                   %--- Zurcksetzen der Nummerierung auf arabisch



% --------------------------------------------------------------------------------
\include{./preface_intro}
% --------------------------------------------------------------------------------

% --------------------------------------------------------------------------------
\include{./grid_geometry}
% --------------------------------------------------------------------------------

% --------------------------------------------------------------------------------
\include{./input}
% --------------------------------------------------------------------------------

% --------------------------------------------------------------------------------
\include{./analysis}
% --------------------------------------------------------------------------------

% --------------------------------------------------------------------------------
\chapter[Global output fields: Forecast runs]{Global output fields:\\ Forecast runs}

\input{./output_GRIB2_global}

% --------------------------------------------------------------------------------
\chapter[EU Nest output fields: Forecast runs]{EU Nest output fields:\\ Forecast runs}
\label{nest:chap_forecast_runs}
\input{./output_GRIB2_nest}
%\input{./cosmo_eu_fields.tex}

% --------------------------------------------------------------------------------
\chapter{Output fields for soil moisture analysis SMA}
\label{output_for_sma}
\input{./output_GRIB2_sma}


% --------------------------------------------------------------------------------
\chapter{Extended description of available output fields}

\input{./output_description}


% --------------------------------------------------------------------------------
\chapter[Remarks on statistical processing and horizontal interpolation]{Remarks on statistical processing and horizontal interpolation}

\input{./output_statproc}
% --------------------------------------------------------------------------------



% --------------------------------------------------------------------------------
\include{./icon_in_sky}
% --------------------------------------------------------------------------------

\begin{appendices}
\include{./appendix}  %--- Einbinden der Appendix
\end{appendices}

\backmatter
\bibliography{litera.bib} %--- Create list of references

% remove chapter number from header for Acknowledgements
\renewcommand{\chaptermark}[1] {
  \markboth{#1}{}
}

% use default again
\renewcommand{\chaptermark}[1]{%
  \markboth{\chaptername
    \ \thechapter.\ #1}{}}


% --------------------------------------------------------------------------------
% --------------------------------------------------------------------------------
%\cleardoublepage
% \section*{Database documentation: list of todos}
% --------------------------------------------------------------------------------
% --------------------------------------------------------------------------------

% \begin{itemize}
%   \item EU nest: ''Urstart'' fields must be contained in the $VV=0$ list.
%   \item lake variables: ask Dimitri if these fields could be changed
%     from RBF interpolation to nearest-neighbor.
%   \item \st{EU nest, output of wind gusts hourly until 78h, afterwards 3
%     hourly:  Output of VMAX\_10M is 3-hourly for $VV>78h$. The
%     sampling interval should also be changed to 3h after $VV>78h$.}
%   \item \st{Create two additional timing diagrams like}
%     \ref{fig:forecast_length_global} \st{for the EU nest: One illustration for
%     native grid and one for the regular output grid.}
%   \item Questions for the ICON migration group:
%         \begin{itemize}
%           \item QR, QS necessary for lon-lat?
%           \item Q\_SEDIM required?
%           \item QV\_2M (lat-lon) required?
%           \item SOBS\_RAD, THBS\_RAD (lat-lon) required?
%           \item TQC\_DIA, TQI\_DIA ?
%           \item REL\_HUM on height levels required?
%           \item CAPE\_ML required?
%           \item CAPE\_CON (lat-lon) required?
%           \item FR\_ICE (lat-lon) required?
%           \item How should DTKE\_CON be treated on the EU nest, native grid?
%         \end{itemize}
%   \item \st{Height-level interpolated pressure: L1/L2 are 102/255 in the COSMO documentation.}
%   \item DTKE\_CON: not consistent with namelist.
% \end{itemize}


\end{document}
