<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>ecmwf_runs_documentation</title>
<meta name="generator" content="DokuWiki" />
<meta name="robots" content="noindex,nofollow" />
<meta name="date" content="2012-06-20T14:30:18+0000" />
<meta name="keywords" content="ecmwf_runs_documentation" />
<link rel="search" type="application/opensearchdescription+xml" href="/~fprill/wiki/lib/exe/opensearch.php" title="Wiki :: florian.prill@dwd.de" />
<link rel="start" href="/~fprill/wiki/" />
<link rel="contents" href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation&amp;do=index" title="Sitemap" />
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="/~fprill/wiki/feed.php" />
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="/~fprill/wiki/feed.php?mode=list&amp;ns=" />
<link rel="alternate" type="text/html" title="Plain HTML" href="/~fprill/wiki/doku.php?do=export_xhtml&amp;id=ecmwf_runs_documentation" />
<link rel="alternate" type="text/plain" title="Wiki Markup" href="/~fprill/wiki/doku.php?do=export_raw&amp;id=ecmwf_runs_documentation" />
<link rel="canonical" href="http://oflxs04.dwd.de/~fprill/wiki/doku.php?id=ecmwf_runs_documentation" />
<link rel="stylesheet" media="screen" type="text/css" href="/~fprill/wiki/lib/exe/css.php?t=drupal-garland-blue&amp;tseed=1327577588" />
<link rel="stylesheet" media="all" type="text/css" href="/~fprill/wiki/lib/exe/css.php?s=all&amp;t=drupal-garland-blue&amp;tseed=1327577588" />
<link rel="stylesheet" media="print" type="text/css" href="/~fprill/wiki/lib/exe/css.php?s=print&amp;t=drupal-garland-blue&amp;tseed=1327577588" />
<script type="text/javascript" ><!--//--><![CDATA[//><!--
var NS='';var JSINFO = {"id":"ecmwf_runs_documentation","namespace":""};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="/~fprill/wiki/lib/exe/js.php?tseed=1327577588" ></script>
</head>
<body>
<div class="dokuwiki export">
<!-- TOC START -->
<div class="toc">
<div class="tocheader toctoggle" id="toc__header">Table of Contents</div>
<div id="toc__inside">

<ul class="toc">
<li class="level1"><div class="li"><span class="li"><a href="#documentation_-_scheduled_runs_of_the_icon_model_at_ecmwf" class="toc">Documentation - Scheduled runs of the ICON model at ECMWF</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="#general_notes" class="toc">General Notes</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#sms_suite_icon_r2b06_10d" class="toc">SMS suite ICON_R2B06_10d</a></span></div>
<ul class="toc">
<li class="level3"><div class="li"><span class="li"><a href="#directory_layout" class="toc">Directory layout</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#suite_definition" class="toc">Suite definition</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#caveats" class="toc">Caveats</a></span></div></li>
</ul>
</li>
<li class="level2"><div class="li"><span class="li"><a href="#technical_infrastructure" class="toc">Technical infrastructure</a></span></div>
<ul class="toc">
<li class="level3"><div class="li"><span class="li"><a href="#setting_up_your_xcdp_client" class="toc">Setting up your XCDP client</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#installation_of_the_sms_suite" class="toc">Installation of the SMS suite</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#rhosts" class="toc">.rhosts</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#svn_access" class="toc">SVN access</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#local_ruby_installation" class="toc">Local Ruby installation</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#local_cdo_installation" class="toc">Local CDO installation</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#grib_api_settings" class="toc">GRIB_API settings</a></span></div></li>
<li class="level3"><div class="li"><span class="li"><a href="#local_settings" class="toc">Local settings</a></span></div></li>
</ul>
</li>
<li class="level2"><div class="li"><span class="li"><a href="#still_todo" class="toc">Still TODO</a></span></div></li></ul>
</li></ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1"><a name="documentation_-_scheduled_runs_of_the_icon_model_at_ecmwf" id="documentation_-_scheduled_runs_of_the_icon_model_at_ecmwf">Documentation - Scheduled runs of the ICON model at ECMWF</a></h1>
<div class="level1">

<p>

<em> Author:  Florian Prill, DWD (2012-06-19). </em>
</p>

</div>
<!-- EDIT1 SECTION "Documentation - Scheduled runs of the ICON model at ECMWF" [1-123] -->
<h2 class="sectionedit2"><a name="general_notes" id="general_notes">General Notes</a></h2>
<div class="level2">

<p>

<strong>Case Setup “ICON_r2B06_10d”</strong>
</p>
<ul>
<li class="level1"><div class="li"> run time: 10 days</div>
</li>
<li class="level1"><div class="li"> time step size: 60 sec, 10*24*3600 / 60 = 14400 steps</div>
</li>
<li class="level1"><div class="li"> output every 3h = 10800 sec, 80 output actions</div>
</li>
</ul>

<p>

<strong>Current restrictions</strong>
</p>
<ul>
<li class="level1"><div class="li"> Results are stored in a dedicated directory, not in a database</div>
</li>
<li class="level1"><div class="li"> IFS2ICON based on Ruby scripting language</div>
</li>
<li class="level1"><div class="li"> GRIB2 output available for plot suite, but still experimental</div>
</li>
<li class="level1"><div class="li"> Multi-user support: No whitelist or other access privileges to the SMS have been installed.</div>
</li>
</ul>

</div>
<!-- EDIT2 SECTION "General Notes" [124-617] -->
<h2 class="sectionedit3"><a name="sms_suite_icon_r2b06_10d" id="sms_suite_icon_r2b06_10d">SMS suite ICON_R2B06_10d</a></h2>
<div class="level2">

<p>

The ICON runs employ ECMWF&#039;s scheduler “SMS”, cf. <a href="http://www.ecmwf.int/publications/manuals/sms/" class="urlextern" title="http://www.ecmwf.int/publications/manuals/sms/"  rel="nofollow">http://www.ecmwf.int/publications/manuals/sms/</a> for detailed documentation.

</p>
<ul>
<li class="level1"><div class="li"> The model is run by a dedicated user, <strong>”<code>deia</code>“</strong>. <br/>
See <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#installation_of_the_sms_suite" class="wikilink1" title="ecmwf_runs_documentation">below</a></span> for instructions on how to set up the SMS suite from scratch.</div>
</li>
<li class="level1"><div class="li"> Different stages of the model run take place on the frontend <code><a href="http://www.ecmwf.int/services/computing/ecgate/index.html" class="urlextern" title="http://www.ecmwf.int/services/computing/ecgate/index.html"  rel="nofollow">ecgate</a></code> and the compute cluster <code><a href="http://www.ecmwf.int/services/computing/ecgate/index.html" class="urlextern" title="http://www.ecmwf.int/services/computing/ecgate/index.html"  rel="nofollow">c1a</a></code> (IBM Power6 cluster<sup><a href="#fn__1" name="fnt__1" id="fnt__1" class="fn_top">1)</a></sup>).  <br/>
When using the <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#setting_up_your_xcdp_client" class="wikilink1" title="ecmwf_runs_documentation">XCDP graphical user interface</a></span>, the actual location of each task is stated in a small info label.</div>
</li>
<li class="level1"><div class="li"> Each task has several <em>events</em>, i.e. notifications when important sub-stages of a task have been completed. <br/>
When using the <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#setting_up_your_xcdp_client" class="wikilink1" title="ecmwf_runs_documentation">XCDP graphical user interface</a></span>, the status of each event is displayed as a label (event name) together with a status icon.</div>
</li>
<li class="level1"><div class="li"> The SMS suite can be <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#setting_up_your_xcdp_client" class="wikilink1" title="ecmwf_runs_documentation">monitored and controlled by other users via CDP login</a></span>.</div>
</li>
<li class="level1"><div class="li"> SMS files are stored in the Redmine <code>svn</code> version control system: <code>trunk/icon-dev/schedulers/ecmwf</code>.</div>
</li>
<li class="level1"><div class="li"> There exists a similar script suite for BCeps (H. Frank, User <code>zde</code>), see <code>/home/ms/de/zde/BCeps/bceps.def</code>.</div>
</li>
</ul>

</div>
<!-- EDIT3 SECTION "SMS suite ICON_R2B06_10d" [618-2190] -->
<h3 class="sectionedit4"><a name="directory_layout" id="directory_layout">Directory layout</a></h3>
<div class="level3">

<p>

The SMS directory structure is necessary on the compute cluster file system, <code>$PERM</code> as well as on <code>ecgate</code>.

</p>
<ul>
<li class="level1"><div class="li"> The actual case setup for ICON is stored in the file <code>def/case_setup</code>.</div>
</li>
<li class="level1"><div class="li"> The SMS suite, i.e. the dependencies between the different tasks, is defined in <code>$HOME/ICON_R2B06_10d/def/smsfiles/icon.def</code></div>
</li>
<li class="level1"><div class="li"> All temporary SMS files are stored in <code>$HOME/sms_server</code> and <code>$HOME/sms</code>.</div>
</li>
<li class="level1"><div class="li"> Temporary results are stored in <code>$TMPDIR</code> on ecgate and <code>$TEMP/sms</code> on the cluster file system.</div>
</li>
</ul>

<p>
All script files and the model setup are located in a directory <code>$HOME/ICON_R2B06_10d</code>
of the following layout:

</p>
<pre class="code">$HOME/ICON_R2B06_10d
    def                    ! scripts for operating the suite
        smsfiles
        include
        icon_scripts       ! checkout from ICON SVN: trunk/icon-dev/scripts
        bin                ! additional script files
    output
        model              ! current model output
        log                ! SMS suite logfiles
    doc                    ! this documentation
    cluster                ! [only on compute cluster]
        icon-dev           ! latest build of SVN trunk [only on compute cluster]
        input              ! static input (time-independent)
            extpar
            grids
            radiation
            ifs2icon       ! model input from IFS
               cellweights</pre>

<p>
<strong>Note:</strong>
Not all necessary contents are stored in the Redmine repository
</p>
<pre class="code"> https://svn.zmaw.de/svn/icon/trunk/icon-dev/schedulers/ecmwf/ICON_r2B06_10d</pre>

<p>
After the initial check-out one must add
</p>
<ul>
<li class="level1"><div class="li"> On <code>ecgate</code> and cluster <code>c1a</code>: <code>def/icon_scripts</code> (from <code><a href="https://svn.zmaw.de/svn/icon/trunk/icon-dev/scripts" class="urlextern" title="https://svn.zmaw.de/svn/icon/trunk/icon-dev/scripts"  rel="nofollow">https://svn.zmaw.de/svn/icon/trunk/icon-dev/scripts</a></code>)</div>
</li>
<li class="level1"><div class="li"> [On cluster:] Check-out of the ICON source code: <code>cluster/icon-dev</code></div>
</li>
</ul>

</div>
<!-- EDIT4 SECTION "Directory layout" [2191-3990] -->
<h3 class="sectionedit5"><a name="suite_definition" id="suite_definition">Suite definition</a></h3>
<div class="level3">

<p>

The complete run of the ICON model is split into different <em>tasks</em>. These tasks are grouped into <em>families</em> and <em>sub-families</em>, for example <em>init</em> and <em>init/build</em>.
Each task corresponds to a <code>*.sms</code> file, stored in the subdirectory <code>smsfiles/def/icon/…</code>, for example <code>smsfiles/def/icon/init/get_data.sms</code>. The <code>*.sms</code> files is an (almost) ordinary script file.
There a basically three types of <code>*.sms</code> files:
</p>
<ul>
<li class="level1"><div class="li"> Scripts running on <code>ecgate</code>: Post-processing etc.</div>
</li>
<li class="level1"><div class="li"> <code>hpc_serial</code>: Scripts running on the <code>c1a</code> frontend: Data retrieval for the cluster <code>c1a</code>.</div>
</li>
<li class="level1"><div class="li"> <code>hpc_parallel</code>: Scripts running in parallel on the compute cluster.</div>
</li>
</ul>

<p>

File names and output directories depend on several variables<sup><a href="#fn__2" name="fnt__2" id="fnt__2" class="fn_top">2)</a></sup>:
</p>
<ul>
<li class="level1"><div class="li"> <code>%SMSDATE%</code>                    <br/>
Current date, defined by the system enviroment.</div>
</li>
<li class="level1"><div class="li"> <code>%SUITE_NAME%</code> (user-defined)  <br/>
Currently set to “ICON_r2B06_10d”. Different suite names could later be used to perform several independent model runs.</div>
</li>
<li class="level1"><div class="li"> <code>$REQUEST_DATE</code> (user-defined) <br/>
The starting date for the forecast. <strong>Currently this is computed as %SMSDATE% - 2 days, time: UTC 00.</strong> </div>
</li>
</ul>

</div>
<!-- EDIT5 SECTION "Suite definition" [3991-5340] -->
<h4 class="sectionedit6"><a name="task_ifs_fct_fct_ifs" id="task_ifs_fct_fct_ifs">Task ifs_fct/fct_ifs</a></h4>
<div class="level4">
<div class="table sectionedit7"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Dummy task, triggered by IFS, initiates ICON SMS suite. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1 leftalign"> <code>ecgate</code>                                              </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1 leftalign"> None.                                                   </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> None.                                                   </td>
	</tr>
</table></div>
<!-- EDIT7 TABLE [5371-5702] -->
<p>

The whole SMS suite is restarted (<code>repeat date</code> keyword) on a regular basis.
The suite contains an artificial dummy task, <code>fct_ifs</code>, whose completion is the starting condition for the whole suite.
</p>

<p>
There exists a small shell script <code>def/smsfiles/job.trigger</code> which is triggered by the IFS framework itself, i.e. via
</p>
<pre class="code"> ecaccess-job-submit</pre>

<p>
This shell script calls a CDP command:
</p>
<pre class="code"> force complete fct_ifs</pre>

<p>
and thus activates the whole ICON SMS suite.
</p>

<p>
Currently, the task is triggered by the <strong>event ID 167</strong>, which means “at this stage, the analysis at 00UTC is complete”.
The task has been registered with
</p>
<pre class="code"> ecaccess-job-submit -noDirectives -eventIds 167 -queueName ecgate $HOME/ICON_r2B06_10d/def/smsfiles/job.trigger </pre>

<p>
More events can be obtained from the list generated by the command
</p>
<pre class="code"> ecaccess-event-list </pre>

<p>
Finally, use
</p>
<pre class="code"> ecaccess-job-list
 ecaccess-job-delete &lt;jobID&gt;</pre>

<p>
to remove a job trigger from the list.
</p>

</div>
<!-- EDIT6 SECTION "Task ifs_fct/fct_ifs" [5341-6627] -->
<h4 class="sectionedit8"><a name="task_init_setup" id="task_init_setup">Task init/setup</a></h4>
<div class="level4">
<div class="table sectionedit9"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1 leftalign"> Set some initial variables and flags.                                    </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1 leftalign"> <code>ecgate</code>                                                               </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1 leftalign"> None.                                                                    </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1"> sets events “enable_build” and “enable_dumpstate” based on current date. </td>
	</tr>
</table></div>
<!-- EDIT9 TABLE [6653-7052] -->
<p>

Some parts of the SMS suite are not run in a daily fashion but less frequently.
For example, dump states (coefficient tables) must be pre-computed only once and a new binary should be compiled only about once a week.
</p>
<ul>
<li class="level1"><div class="li"> The event <code>init/setup:enable_dumpstate</code> controls if a dump state is computed.</div>
</li>
<li class="level1"><div class="li"> The event <code>init/setup:enable_build</code> controls if a new binary is compiled.</div>
</li>
</ul>

<p>

<span style='color:red; '>Currently (test phase of the SMS suite), the variable <code>enable_dumpstate</code> is always <strong>en</strong>abled, while <code>enable_build</code> is always disabled.</span>

</p>

</div>
<!-- EDIT8 SECTION "Task init/setup" [6628-7595] -->
<h4 class="sectionedit10"><a name="task_init_get_data" id="task_init_get_data">Task init/get_data</a></h4>
<div class="level4">
<div class="table sectionedit11"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Retrieve IFS data from MARS database. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_serial</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1 leftalign"> None.                                                   </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Retrieved <code>*.grb</code> file is stored in <code>$PERM/%SUITE_NAME%/cluster/input/ifs2icon</code>  </td>
	</tr>
</table></div>
<!-- EDIT11 TABLE [7624-7925] -->
</div>
<!-- EDIT10 SECTION "Task init/get_data" [7596-7929] -->
<h4 class="sectionedit12"><a name="task_init_init_data" id="task_init_init_data">Task init/init_data</a></h4>
<div class="level4">
<div class="table sectionedit13"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Run converter <code>IFS2ICON</code>. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_serial</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> GRIB file stored in <code>$PERM/%SUITE_NAME%/cluster/input/ifs2icon</code> (moved by this task) </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1 leftalign"> IFS2ICON config file in <code>$PERM/%SUITE_NAME%/def/ifs2icon_1279.conf</code>  </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1 leftalign"> Grid files in <code>$PERM/%SUITE_NAME%/cluster/input/grids</code>  </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Conversion result (NetCDF format) and the GRIB file in <code>$TEMP/sms/input/%SUITE_NAME/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/  </td>
	</tr>
</table></div>
<!-- EDIT13 TABLE [7959-8505] --><ul>
<li class="level1"><div class="li"> The task <code>init_data</code> comprises the computation of cell_weights – but only if they have not been previously computed. This is indicated by the existence of a file</div>
</li>
</ul>
<pre class="code">        cluster/input/ifs2icon/cellweights/initialized.flag</pre>
<ul>
<li class="level1"><div class="li"> The task <code>init_data</code> loads the Climate data Operators <code>cdo</code> version 1.5.0. Note that the default version 1.4.6 installed on <code>c1a</code> cannot be used with <code>ifs2icon</code> while for the newer 1.5.3 NetCDF support has not been compiled in.</div>
</li>
<li class="level1"><div class="li"> The <code>ifs2icon</code> script contains a call to <code>cdo merge</code> which consumes a considerable amount of memory (for R2B06, the default of ~780MB is not sufficient). </div>
</li>
</ul>

</div>
<!-- EDIT12 SECTION "Task init/init_data" [7930-9146] -->
<h4 class="sectionedit14"><a name="task_init_build_init_svn" id="task_init_build_init_svn">Task init/build/init_svn</a></h4>
<div class="level4">
<div class="table sectionedit15"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Update ICON sources. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>ecgate</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Source code in directory <code>c1a:$PERM/%SUITE_NAME%/cluster/icon-dev</code>  </td>
	</tr>
</table></div>
<!-- EDIT15 TABLE [9181-9363] -->
<p>

There are two modes, depending on user-defined <code>%SVN_UPDATE%</code> flag:
</p>

<p>
<strong>Subversion update</strong>
</p>

<p>
Requires an existing source directory on compute cluster <code>c1a</code>. 
Apply only <code>svn update</code> and <code>gmake distclean</code> to retrieve the source code from the repository.
</p>

<p>
<strong>Tar-ball export</strong>
</p>

<p>
SVN export of a source copy in <code>$TMPDIR/icon-dev</code> (on <code>ecgate</code>), copy to the compute cluster <code>c1a</code>, where the files will be extracted (in task <code>init/build/init_build</code>).
</p>

</div>
<!-- EDIT14 SECTION "Task init/build/init_svn" [9147-9825] -->
<h4 class="sectionedit16"><a name="task_init_build_init_build" id="task_init_build_init_build">Task init/build/init_build</a></h4>
<div class="level4">
<div class="table sectionedit17"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Build ICON binary. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_parallel</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> Updated source directory, <code>c1a:$PERM/%SUITE_NAME%/cluster/icon-dev</code> </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Binary in <code>c1a:$PERM/%SUITE_NAME%/cluster/icon-dev/build/…/bin/</code>  </td>
	</tr>
</table></div>
<!-- EDIT17 TABLE [9862-10145] -->
<p>

The build process always starts from a clean directory, i.e. the <em class="u">complete</em> is recompiled.
</p>

<p>
<strong>Note:</strong> The binary is configured with <code>-O3</code> optimization enabled, which requires a considerable amount of time on the PWR6. 
</p>

</div>
<!-- EDIT16 SECTION "Task init/build/init_build" [9826-10371] -->
<h4 class="sectionedit18"><a name="task_forecast_prepare_pre_clean" id="task_forecast_prepare_pre_clean">Task forecast/prepare/pre_clean</a></h4>
<div class="level4">
<div class="table sectionedit19"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Clear directory with model run and output directory. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_serial</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Clears output directory <code>%TEMP%/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/  </td>
	</tr>
</table></div>
<!-- EDIT19 TABLE [10413-10659] -->
</div>
<!-- EDIT18 SECTION "Task forecast/prepare/pre_clean" [10372-10661] -->
<h4 class="sectionedit20"><a name="task_forecast_prepare_dumpstate" id="task_forecast_prepare_dumpstate">Task forecast/prepare/dumpstate</a></h4>
<div class="level4">
<div class="table sectionedit21"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Create dump state (containing coefficient tables for ICON run). </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_parallel</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> Case setup in <code>$PERM/%SUITE_NAME%/def</code>. </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> IFS data in <code>$TEMP/sms/input/</code>. </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> <code>control_model</code> binary in<code>$PERM/%SUITE_NAME%/cluster/icon-dev/build/…/bin/</code>. </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Dump state in <code>$TEMP/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/  </td>
	</tr>
</table></div>
<!-- EDIT21 TABLE [10703-11191] -->
</div>
<!-- EDIT20 SECTION "Task forecast/prepare/dumpstate" [10662-11195] -->
<h4 class="sectionedit22"><a name="task_forecast_model" id="task_forecast_model">Task forecast/model</a></h4>
<div class="level4">
<div class="table sectionedit23"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Model run. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_parallel</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> Case setup in <code>$PERM/%SUITE_NAME%/def</code>. </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> IFS data in <code>$TEMP/sms/input/</code>. </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> <code>control_model</code> binary in<code>$PERM/%SUITE_NAME%/cluster/icon-dev/build/…/bin/</code>. </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1 leftalign"> Dump state in <code>$TEMP/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/  </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Model output in <code>$TEMP/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/  </td>
	</tr>
</table></div>
<!-- EDIT23 TABLE [11225-11776] -->
<p>

On abort or completion: Terminates the SMS task <code>“check_progress”</code> by calling the utility script <code>cancel_check_progress</code>.
</p>

</div>
<!-- EDIT22 SECTION "Task forecast/model" [11196-11907] -->
<h4 class="sectionedit24"><a name="task_forecast_check_progress" id="task_forecast_check_progress">Task forecast/check_progress</a></h4>
<div class="level4">
<div class="table sectionedit25"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Check for available output files. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>ecgate</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <strong>Provides output:</strong> </td><td class="col1 leftalign"> Increases SMS meter <code>“progress”</code>.  </td>
	</tr>
</table></div>
<!-- EDIT25 TABLE [11946-12108] -->
<p>

When using the <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#setting_up_your_xcdp_client" class="wikilink1" title="ecmwf_runs_documentation">XCDP graphical user interface</a></span> the current number of output files is displayed as a graphical progress bar. Please note that the timing might be inaccurate because the output directory is polled infrequently. 
The value of the progress meter is used to trigger the post-processing tasks of the suite.
</p>

<p>
Terminates, if all NetCDF output files are available in <code>c1a:$TEMP/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/ or if on <code>ecgate</code> a file <code>$HOME/sms/model_complete.flag</code> has been created. 

</p>

</div>
<!-- EDIT24 SECTION "Task forecast/check_progress" [11908-12694] -->
<h4 class="sectionedit26"><a name="task_post_post_process" id="task_post_post_process">Task post/post_process</a></h4>
<div class="level4">

<p>

This task is called for each output step separately.
</p>

<p>
<span style='color:red; '>Not yet implemented, only a “dummy” call to <code>grib_ls</code>!</span>

</p>
<div class="table sectionedit27"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Extract output, generate plots. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>hpc_serial</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> Model output in <code>$TEMP/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/ </td>
	</tr>
</table></div>
<!-- EDIT27 TABLE [12858-13074] -->
<p>

The calling frequency of this post-processing task is probably too high: It is invoked each time after new output file has been written to disk.
That is, 80 post-processing tasks are launched on <code>hpc_serial</code> (<code>c1a</code>).
One could also design a post-processing mechanism which is invoked only <em class="u">once</em>, after the final output file has been created. 
For this, adjust the <code>repeat</code> and <code>trigger</code> keywords in the SMS suite definition file
</p>
<pre class="code"> $HOME/ICON_R2B06_10d/def/smsfiles/icon.def</pre>

<p>
See ECMWF&#039;s <a href="http://www.ecmwf.int/publications/manuals/sms/" class="urlextern" title="http://www.ecmwf.int/publications/manuals/sms/"  rel="nofollow">SMS documentation</a> on how to modify this setting.

</p>

</div>
<!-- EDIT26 SECTION "Task post/post_process" [12695-13673] -->
<h4 class="sectionedit28"><a name="task_post_post_archive" id="task_post_post_archive">Task post/post_archive</a></h4>
<div class="level4">

<p>

<span style='color:red; '>Not yet implemented!</span>

</p>
<div class="table sectionedit29"><table class="inline">
	<tr class="row0">
		<td class="col0 leftalign"> <strong>Objectives:</strong>      </td><td class="col1"> Copy output and/or store in database and/or trigger transfer to DWDExtract output, generate plots. </td>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign"> <strong>Platform:</strong>        </td><td class="col1"> <code>ecgate</code> </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign"> <strong>Requires input:</strong>  </td><td class="col1"> Model output in <code>$TEMP/sms/output/%SUITE_NAME%/</code><span style='color:red; '><code>$REQUEST_DATE</code></span>/ </td>
	</tr>
</table></div>
<!-- EDIT29 TABLE [13747-14026] -->
</div>
<!-- EDIT28 SECTION "Task post/post_archive" [13674-14028] -->
<h3 class="sectionedit30"><a name="caveats" id="caveats">Caveats</a></h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> In case of failure or due to manual settings, if CDP reports a task on the compute cluster as “aborted”, the corresponding job might be still be queued or running and must be manually removed (<code>llcancel</code>)! Check also for shell scripts running in the background on <code>ecgate</code> (especially utility script <code><span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#task_forecast_check_progress" class="wikilink1" title="ecmwf_runs_documentation">cancel_check_progress</a></span></code>).</div>
</li>
<li class="level1"><div class="li"> The input/output directories of older runs are not yet actively removed but left in place.</div>
</li>
<li class="level1"><div class="li"> If the ICON model crashes due to a <code>CALL finish(…)</code> this is not reliably reported to the operating system. Therefore the tasks <code><span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#task_forecast_model" class="wikilink1" title="ecmwf_runs_documentation">model</a></span></code> and <code><span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#task_forecast_prepare_dumpstate" class="wikilink1" title="ecmwf_runs_documentation">dumpstate</a></span></code> may appear as “completed” while they have in fact crashed, for example due to a missing input file.</div>
</li>
</ul>

</div>
<!-- EDIT30 SECTION "Caveats" [14029-14910] -->
<h2 class="sectionedit31"><a name="technical_infrastructure" id="technical_infrastructure">Technical infrastructure</a></h2>
<div class="level2">

</div>
<!-- EDIT31 SECTION "Technical infrastructure" [14911-14948] -->
<h3 class="sectionedit32"><a name="setting_up_your_xcdp_client" id="setting_up_your_xcdp_client">Setting up your XCDP client</a></h3>
<div class="level3">

<p>

<code>deia</code>&#039;s ICON SMS suite can be viewd and controlled from your own ECMWF account via the graphical frontend “xcdp”:
Launch
</p>
<pre class="code">xcdp</pre>

<p>
and open the menu
</p>
<pre class="code">Edit -&gt; Preferences -&gt; Servers</pre>

<p>
There, add a new server by typing
</p>
<pre class="code">Name:   deia
Host:   ecgate
Number: 901730</pre>

<p>
(where “901730” denotes the SMS ID provided by <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#sms_start" class="wikilink1" title="ecmwf_runs_documentation">sms_start</a></span>).
Then, close the preferences dialog and log into the SMS suite by the menu item
</p>
<pre class="code">Servers -&gt; deia</pre>

<p>

<strong>Note:</strong> Currently, the SMS suite is started at about 7:30 CEST and runs less than 60 minutes. Therefore, for most of the day, the XCDP status of the suite is “queued” (blue-gray color)!
</p>

<p>
<a href="/~fprill/wiki/lib/exe/detail.php?id=ecmwf_runs_documentation&amp;media=pic_sms_icon.jpg" class="media" title="pic_sms_icon.jpg"><img src="/~fprill/wiki/lib/exe/fetch.php?w=200&amp;media=pic_sms_icon.jpg" class="media" title="Diagram of the ICON SMS suite" alt="Diagram of the ICON SMS suite" width="200" /></a>
</p>

</div>
<!-- EDIT32 SECTION "Setting up your XCDP client" [14949-15696] -->
<h3 class="sectionedit33"><a name="installation_of_the_sms_suite" id="installation_of_the_sms_suite">Installation of the SMS suite</a></h3>
<div class="level3">

</div>
<!-- EDIT33 SECTION "Installation of the SMS suite" [15697-15737] -->
<h4 class="sectionedit34"><a name="sms_start" id="sms_start">sms_start</a></h4>
<div class="level4">

<p>

command
</p>
<pre class="code"> sms_start</pre>

<p>
gives

</p>
<pre class="code">User &quot;3455&quot; attempting to start sms server on &quot;ecgate&quot; using PROGNUM = &quot;903455&quot; and with SMSHOME of &quot;$HOME/sms_server&quot;

Checking if the SMS is already running on ecgate
...</pre>

<p>

Then write host and number to <code>.cdprc</code>:
</p>
<pre class="code"> alias myalias set SMS_PROG 903455 \; login ecgate UID 1</pre>

<p>
where ”<code>903455</code>” should be replaced by the provided <code>PROGNUM</code> value.

</p>

</div>
<!-- EDIT34 SECTION "sms_start" [15738-16145] -->
<h4 class="sectionedit35"><a name="running_the_suite" id="running_the_suite">Running the suite</a></h4>
<div class="level4">

<p>

Initially create a directory structure for the SMS log files:

</p>
<pre class="code"> cd
 mkdir sms
 mkdir sms/icon
 mkdir sms/icon/init
 mkdir sms/icon/forecast
 mkdir sms/icon/post    
 mkdir sms/icon/init/build
 mkdir sms/icon/forecast/prepare</pre>

<p>

Similarly, on the compute cluster <code>c1a</code>:

</p>
<pre class="code"> cd $TEMP
 mkdir sms
 mkdir sms/icon
 mkdir sms/icon/init
 mkdir sms/icon/forecast
 mkdir sms/icon/post    
 mkdir sms/icon/init/build
 mkdir sms/icon/forecast/prepare</pre>

<p>

In the <code>$HOME/.cdprc</code> file, several utility routines have been defined:
Start the suite with   
</p>
<pre class="code"> cdp
 
 CDP&gt; myalias    
 CDP&gt; play icon.def
 CDP&gt; begin icon   </pre>

<p>
If there exists already a running SMS suite, you can relaunch the whole setup with
</p>
<pre class="code"> cdp
 
 CDP&gt; total_restart</pre>

<p>
Check the status of the suite with
</p>
<pre class="code"> cdp
 
 CDP&gt; myalias 
 CDP&gt; status -f
      /{sub}   icon{sub}   t1[sub]   </pre>

</div>
<!-- EDIT35 SECTION "Running the suite" [16146-17051] -->
<h4 class="sectionedit36"><a name="logserver" id="logserver">Logserver</a></h4>
<div class="level4">

<p>

On the compute cluster <code>c1a</code> a special process is in charge of copying log files back to <code>ecgate</code> s.t. they can be viewed in <code>xcdp</code>:
</p>
<pre class="code">  cd $PERM/ICON_r2B06_10d/def/bin
  ./logserver</pre>

<p>
Now a log server daemon must be running: The command line
</p>
<pre class="code">  ps -ef | grep $USER</pre>

<p>
yield something like
</p>
<pre class="code">  ...  418144       1   0 10:34:29 pts/172  0:00 /usr/bin/perl /usr/local/bin/logsvr.pl </pre>

</div>
<!-- EDIT36 SECTION "Logserver" [17052-17457] -->
<h3 class="sectionedit37"><a name="rhosts" id="rhosts">.rhosts</a></h3>
<div class="level3">

<p>

Enable <code>rcp</code> and <code>rsh</code> between the compute cluster and <code>ecgate</code> by setting the <code>$HOME/.rhosts</code> file:
</p>
<pre class="code">  echo &quot;ecga02 $USER&quot; &gt;&gt; ~/.rhosts</pre>

<p>
For copying files between ecgate and compute cluster use the commands <code>rcp</code> or <code>ecrcp</code>.

</p>

</div>
<!-- EDIT37 SECTION ".rhosts" [17458-17714] -->
<h3 class="sectionedit38"><a name="svn_access" id="svn_access">SVN access</a></h3>
<div class="level3">

<p>

SVN access is required
</p>
<ul>
<li class="level1"><div class="li"> for the SMS scripts, </div>
</li>
<li class="level1"><div class="li"> for the <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#task_init_build_init_svn" class="wikilink1" title="ecmwf_runs_documentation">creation of automatic builds</a></span>.</div>
</li>
</ul>

<p>
Please note: For direct access to ZMAW&#039;s subversion repository, changes in <code>$HOME/.subversion/servers</code>
are necessary:
</p>
<pre class="code">  http-proxy-host = ******
  http-proxy-port = ******</pre>

<p>
(Inofficial access, ask L. Kornblueh, F. Prill for details).
</p>

<p>
Note that on <code>c1a</code> no <acronym title="Secure Sockets Layer">SSL</acronym> support is available, therefore type

</p>
<pre class="code">  svn co http://svn.zmaw.de/svn/icon/trunk/icon-dev/schedulers/ecmwf/ICON_r2B06_10d</pre>

<p>

on the command line for <code>c1a</code>.

</p>

</div>
<!-- EDIT38 SECTION "SVN access" [17715-18319] -->
<h3 class="sectionedit39"><a name="local_ruby_installation" id="local_ruby_installation">Local Ruby installation</a></h3>
<div class="level3">

<p>

Script language <code>ruby</code> has to be installed locally (user account).
It is required by the <span class="curid"><a href="/~fprill/wiki/doku.php?id=ecmwf_runs_documentation#task_init_init_data" class="wikilink1" title="ecmwf_runs_documentation">IFS2ICON task</a></span>.
</p>

<p>
Prerequisites:
</p>
<ol>
<li class="level1"><div class="li"> Ruby source code downloaded from <a href="http://www.ruby-lang.org/de/downloads/" class="urlextern" title="http://www.ruby-lang.org/de/downloads/"  rel="nofollow">http://www.ruby-lang.org/de/downloads/</a> to <code>$PERM/software</code>.</div>
</li>
<li class="level1"><div class="li"> Package “extcsv” required; download from <a href="http://rubygems.org/gems/extcsv" class="urlextern" title="http://rubygems.org/gems/extcsv"  rel="nofollow">http://rubygems.org/gems/extcsv</a> to <code>$PERM/software/packages</code>.</div>
</li>
<li class="level1"><div class="li"> Package “gnuplot” required; download from <a href="http://rubygems.org/gems/gnuplot" class="urlextern" title="http://rubygems.org/gems/gnuplot"  rel="nofollow">http://rubygems.org/gems/gnuplot</a> to <code>$PERM/software/packages</code>.</div>
</li>
</ol>

<p>
Installation process:
</p>
<pre class="code">tar xvf ruby-1.9.3-p125.tar
cd ruby-1.9.3-p125
./configure --prefix=$PERM/software/ruby-1.9.3-p125_build
gmake -j6
gmake install
cd ../packages
$PERM/software/ruby-1.9.3-p125_build/bin/gem install extcsv
$PERM/software/ruby-1.9.3-p125_build/bin/gem install gnuplot</pre>

<p>
Patch required: In <code>$PERM/software/ruby-1.9.3-p125_build/lib/ruby/gems/1.9.1/gems/extcsv-0.12.0/lib/extcsv_diagram.rb</code> comment out require statement:
</p>
<pre class="code"> #require &#039;extcsv_units&#039;
 </pre>

</div>
<!-- EDIT39 SECTION "Local Ruby installation" [18320-19347] -->
<h3 class="sectionedit40"><a name="local_cdo_installation" id="local_cdo_installation">Local CDO installation</a></h3>
<div class="level3">

<p>

It is necessary to compile a local version of the <a href="https://code.zmaw.de/projects/cdo/files" class="urlextern" title="https://code.zmaw.de/projects/cdo/files"  rel="nofollow">Climate Data Operators</a>, which is <em class="u">newer</em> than v1.5.0,
because the system installation of the CDOs on <code>c1a</code> has not been compiled with NetCDF support.
The configure script must be provided with the correct system paths for NetCDF, Jasper and GRIB_<acronym title="Application Programming Interface">API</acronym>:

</p>
<pre class="code">ls -rlt
gunzip cdo-1.5.4.tar.gz
tar xvf cdo-1.5.4.tar
cd cdo-1.5.4
CC=xlc_r CFLAGS=&quot;-g -O3 -q64 -qhot -qarch=auto -qtune=auto -qsmp=omp -DHAVE_MMAP&quot; 
./configure -with-netcdf=/usr/local/apps/netcdf/3.6.3/LP64 \
 --prefix=$PERM/software/cdo-1.5.4_build \
 --with-grib_api=/usr/local/lib/metaps/lib/grib_api/1.9.9 \
 --with-jasper=/usr/local/apps/jasper/1.900.1/LP64 \
 --with-threads=yes
gmake -j2
gmake install</pre>

<p>

After successful compilation, all IFS2ICON processes must run with
</p>
<pre class="code"> $PERM/software/cdo-1.5.4_build/bin/cdo</pre>

<p>
To this end, the task <code>init_data.sms</code> exports an environment variable <code>CDOBIN</code> which is then used by the
Ruby script <code>ifs2icon.rb</code>.
</p>

</div>
<!-- EDIT40 SECTION "Local CDO installation" [19348-20404] -->
<h3 class="sectionedit41"><a name="grib_api_settings" id="grib_api_settings">GRIB_API settings</a></h3>
<div class="level3">

<p>

We want to use the same IFS2ICON configuration settings for ECMWF as well as for DWD, therefore the GRIB2 short names must be taken from DWD&#039;s definition files:
</p>
<pre class="code"> export GRIB_DEFINITION_PATH=%SCPERM%/software/usr/local/grib_api/release/share-1.9.9/definitions.edzw:/usr/local/lib/metaps/lib/grib_api/1.9.9/share/definitions</pre>

<p>
The directory ”%SCPERM%/software/usr/local/grib_api/release/share-1.9.9/definitions.edzw” can be tar&#039;ed and copied from DWD&#039;s HPC file system.
</p>

<p>
<em>Alternative approach:</em>
DWD GRIB definitions are already installed under
</p>
<pre class="code"> ~dwd/grib_api/definitions.edzw-${my_api_version}</pre>

<p>
One can set them using the script <code>/home/ms/de/dw7/bin/grib_def</code>.
</p>

</div>
<!-- EDIT41 SECTION "GRIB_API settings" [20405-21098] -->
<h3 class="sectionedit42"><a name="local_settings" id="local_settings">Local settings</a></h3>
<div class="level3">

<p>

The MARS4ICON script must be executable:
</p>
<pre class="code">   chmod +x $PERM/ICON_r2B06_10d/def/icon_scripts/preprocessing/mars4icon_smi_32r3+</pre>

<p>

MARS4ICON requires DWD&#039;s date conversion script <code>datconv</code>, which must be in <acronym title="Practical Extraction and Report Language">PERL</acronym>&#039;s search path:
</p>
<pre class="code">   cd $HOME/bin
   ln -s ~dfr/routfox/bin/datconv .
   ln -s ~dfr/routfox $HOME/
   export PERL5LIB=&quot;$HOME/routfox/perl&quot;</pre>

</div>
<!-- EDIT42 SECTION "Local settings" [21099-21480] -->
<h2 class="sectionedit43"><a name="still_todo" id="still_todo">Still TODO</a></h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Write platform independent scripts (using includes and conditionals).</div>
</li>
<li class="level1"><div class="li"> (With full access to IFS MARS data:) Enable retrieval for SMSDATE in task <code>get_data.sms</code></div>
</li>
<li class="level1"><div class="li"> increase no. of SMSTRIES for operational use</div>
</li>
<li class="level1"><div class="li"> <del>set wall clock time limits and node numbers</del></div>
</li>
<li class="level1"><div class="li"> check error code of the model binary</div>
</li>
<li class="level1"><div class="li"> runs build and dumpstate computation with a larger frequency.</div>
</li>
<li class="level1"><div class="li"> <del>Show a current computation date in XCDP</del></div>
</li>
<li class="level1"><div class="li"> Use multi-threaded version of CDOs</div>
</li>
<li class="level1"><div class="li"> Use <code>/home/ms/de/dw7/bin/grib_def</code> for GRIB definition.</div>
</li>
<li class="level1"><div class="li"> <del>perform IFS2ICON in a temporary directory (otherwise this might exceed the quota on <code>$PERM</code>).</del></div>
</li>
<li class="level1"><div class="li"> <del>Use SVN access on c1a for SVN update</del></div>
</li>
<li class="level1"><div class="li"> <del>Build with <code>-O3</code></del></div>
</li>
<li class="level1"><div class="li"> For service monitoring: send a daily status e-mail.</div>
</li>
<li class="level1"><div class="li"> Implement some <em>ready file mechanism</em>, i.e. some mechanism which makes sure that an output file has been completed (not only opened and partially written) before accessing it by a post-processing task.</div>
</li>
</ul>

</div>
<!-- EDIT43 SECTION "Still TODO" [21481-] --><div class="footnotes">
<div class="fn"><sup><a href="#fnt__1" id="fn__1" name="fn__1" class="fn_bot">1)</a></sup> 
Important note: The SMS suite is targeted at the compute cluster c1a which will go out of service in 2012.</div>
<div class="fn"><sup><a href="#fnt__2" id="fn__2" name="fn__2" class="fn_bot">2)</a></sup> 
Keep in mind that there exist two sets of variables: System environment variables are denoted by the dollar (”<code>$</code>”) sign, while SMS variables are denoted by the percent (”<code>%</code>”) sign.</div>
</div>
</div>
</body>
</html>
