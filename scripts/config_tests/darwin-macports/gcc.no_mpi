#!/bin/bash

# In this example we assume that you have already installed and activated the
# following packages on your system using MacPorts:
#
#   gcc6
#   netcdf +gcc6
#   netcdf-fortran +gcc6
#   lapack +gcc6
#
# If that is not the case, you can run the installation commands listed in
# the file 'port_install', which you can find in the directory containing this
# example:
#
# sudo port -F ./port_install

set -eu

MY_DIR=$(cd "$(dirname "$0")"; pwd)
ICON_DIR=$(cd "${MY_DIR}/../../.."; pwd)

FC=gfortran
CC=gcc

FCFLAGS='-O2 -g -I/opt/local/include'
CFLAGS='-O2 -g'
CPPFLAGS='-I/opt/local/include'
LDFLAGS='-L/opt/local/lib'
LIBS='-llapack -lblas -lnetcdff -lnetcdf'

"${ICON_DIR}/configure" \
CC="$CC" \
CFLAGS="$CFLAGS" \
CPPFLAGS="$CPPFLAGS" \
FC="$FC" \
FCFLAGS="$FCFLAGS" \
LDFLAGS="$LDFLAGS" \
LIBS="$LIBS" \
--disable-coupling \
--disable-jsbach \
--disable-mpi \
--disable-ocean \
--disable-psrad \
--enable-openmp \
"$@"
