#! /bin/bash
#________________________________________________________________________________________________
#
# Luis Kornblueh, MPI-M, 2013-06-24
#
#________________________________________________________________________________________________
#
#
set -eu
#
#________________________________________________________________________________________________
#
# cmake $(pwd) is doing in-source build - only to get Find<*>.cmake running.
#
# GCC: gcc, gfortran
#
# cleanup old stuff
#
find . -name CMakeCache.txt -print -exec rm -f {} \; || ret=$?
#
find . -name CMakeFiles -print -exec rm -rf {} \; || ret=$?
#________________________________________________________________________________________________
#
# select machine specifics
#
case $(hostname) in
    thunder*)
	set +u
	. /sw/share/Modules/init/bash
	set -u
	# test for FindNETCDF.cmake with netcdf-3.6.3
	#
	#CC=gcc \
	#CFLAGS=-DpgiFortran \
	#FC=gfortran \
	#NETCDFROOT=/scratch/mpi/mh0033/m214089/sandbox/netcdf-3.6.3 \
	#cmake $(pwd)
	#
	# test for FindNETCDF.cmake with netcdf-4.1.3
	# 
	#CC=gcc CFLAGS=-DpgiFortran \
	#FC=gfortran \
	#NETCDFROOT=/sw/squeeze-x64/netcdf-4.1.3-static-gcc47 \
	#cmake $(pwd)
	#
	# test for FindNETCDF.cmake with netcdf-4.2.1.1
	# 
	module load mvapich2/1.9b-static-gcc47 
        
	CC=gcc CFLAGS=-DpgiFortran \
	FC=gfortran \
	NETCDFROOT=/sw/squeeze-x64/netcdf-4.2.1.1-static \
	NETCDFFROOT=/sw/squeeze-x64/netcdf_fortran-4.2-static-gcc47 \
        HDF5ROOT=/sw/squeeze-x64/hdf5-1.8.8-static \
	cmake $(pwd)
        ;;
    wanglung*)
	CC=gcc CFLAGS=-DpgiFortran \
	FC=gfortran \
	NETCDFROOT=/opt/local \
	NETCDFFROOT=/opt/local \
	cmake $(pwd)
	;;
    thingol*)
	CC=gcc CFLAGS=-DpgiFortran \
	FC=gfortran \
	NETCDFROOT=/usr \
	NETCDFFROOT=/usr \
	cmake $(pwd)
	;;
esac

#________________________________________________________________________________________________
#

#
#________________________________________________________________________________________________
